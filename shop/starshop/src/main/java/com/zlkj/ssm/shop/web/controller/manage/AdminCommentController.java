package com.zlkj.ssm.shop.web.controller.manage;import org.apache.commons.lang.StringUtils;import org.springframework.beans.factory.annotation.Autowired;import org.springframework.stereotype.Controller;import org.springframework.web.bind.annotation.RequestMapping;import org.springframework.web.bind.annotation.RequestMethod;import com.zlkj.ssm.shop.core.ManageContainer;import com.zlkj.ssm.shop.core.page.PagerModel;import com.zlkj.ssm.shop.manage.entity.Comment;import com.zlkj.ssm.shop.manage.service.AdminCommentService;import com.zlkj.ssm.shop.web.controller.BaseController;import com.zlkj.ssm.shop.web.tools.RequestHolder;/** * 评论管理 */@Controller@RequestMapping("/manage/comment/")public class AdminCommentController extends BaseController<Comment> {    @Autowired    private AdminCommentService commentService;    private static final String page_toList = "/manage/comment/commentList";    private static final String page_redirect_selectAllList = "redirect:selectList";    private static final String page_toAdd = "/manage/comment/commentEdit";    private static final String page_toEdit = "/manage/comment/commentEdit";    private AdminCommentController() {        super.page_toList = page_toList;        super.page_toAdd = page_toAdd;        super.page_toEdit = page_toEdit;    }    @Override    public AdminCommentService getService() {        return commentService;    }    @Override    protected void selectListAfter(PagerModel pager) {        pager.setPagerUrl("selectList");    }    public void setCommentService(AdminCommentService commentService) {        this.commentService = commentService;    }    @Override    public void insertAfter(Comment e) {        e.clear();    }    /**     * 设置选中的评论显示     *     * @return     * @throws Exception     */    @RequestMapping(value = "updateStatusY", method = RequestMethod.POST)    public String updateStatusY(String[] ids) throws Exception {        if (ids != null && ids.length > 0) {            commentService.updateStatus(ids, Comment.comment_status_y);        }        return page_redirect_selectAllList;    }    /**     * 设置选中的评论不显示     *     * @return     * @throws Exception     */    @RequestMapping(value = "updateStatusN", method = RequestMethod.POST)    public String updateStatusN(String[] ids) throws Exception {        if (ids != null && ids.length > 0) {            commentService.updateStatus(ids, Comment.comment_status_n);        }        return page_redirect_selectAllList;    }    /**     * 回复用户评论     *     * @return     * @throws Exception     */    @RequestMapping(value = "updateReply", method = RequestMethod.POST)    public String updateReply(Comment e) throws Exception {        if (StringUtils.isBlank(e.getReply()) || StringUtils.isBlank(e.getId())) {            throw new NullPointerException(ManageContainer.OrderAction_param_null);        }//		String update = getRequest().getParameter("update");//y:修改回复//		if(update.equals("y")){//			Comment ee = commentService.selectById(e.getId());//			if(ee==null){//				throw new NullPointerException("查询不到评论信息!");//			}//			//			ee.setReply(e.getReply());//		}        Comment c = new Comment();        c.setId(e.getId());        c.setReply(e.getReply());        commentService.update(c);//		return selectList();        return page_redirect_selectAllList;    }    @Override    protected void setParamWhenInitQuery(Comment e) {        super.setParamWhenInitQuery(e);        String selectCommentFromIndex = RequestHolder.getRequest().getParameter("selectCommentFromIndex");        if (StringUtils.isNotBlank(selectCommentFromIndex)) {            e.setSelectCommentFromIndex(Boolean.valueOf(selectCommentFromIndex));        }    }}